apiVersion: grizzly.grafana.com/v1alpha1
kind: Dashboard
metadata:
    folder: duplo-slo
    name: $duplo_uuid
spec:
    annotations:
        list:
            - builtIn: 1
              datasource:
                type: grafana
                uid: -- Grafana --
              enable: true
              hide: true
              iconColor: rgba(0, 211, 255, 1)
              name: Annotations and Alerts
              target:
                limit: 100
                matchAny: false
                tags: []
                type: dashboard
              type: dashboard
    editable: true
    fiscalYearStartMonth: 0
    graphTooltip: 1
    links: []
    panels:
        - datasource:
            type: datasource
            uid: grafana
          gridPos:
            h: 4
            w: 9
            x: 0
            "y": 0
          id: 1
          options:
            code:
                language: plaintext
                showLineNumbers: false
                showMiniMap: false
            content: |
                <div style="font-family: Arial, sans-serif; margin: 20px; text-align: center;">
                    <h1 style="margin: 0; font-size: 3em; font-weight: bold; color: rgb(255, 94, 98);">$name</h1>
                    <h2 style="margin: 10px 0 0; font-size: 1.5em; font-weight: normal; color: rgb(0, 164, 239);">$description</h2>
                </div>
            mode: html
          targets:
            - datasource:
                type: datasource
                uid: grafana
              refId: A
          transparent: true
          type: text
        - datasource:
            type: prometheus
            uid: duplo-metrics
          description: The time window over which the service level objective is being measured over
          fieldConfig:
            defaults:
                color:
                    mode: thresholds
                mappings: []
                max: 1
                min: 0
                thresholds:
                    mode: absolute
                    steps:
                        - color: '#8AB8FF'
                          value: null
                unit: percentunit
            overrides: []
          gridPos:
            h: 4
            w: 5
            x: 9
            "y": 0
          id: 2
          options:
            colorMode: value
            graphMode: area
            justifyMode: auto
            orientation: auto
            percentChangeColorMode: standard
            reduceOptions:
                calcs:
                    - lastNotNull
                fields: /.*/
                values: false
            showPercentChange: false
            textMode: auto
            wideLayout: true
          targets:
            - datasource:
                type: prometheus
                uid: duplo-metrics
              editorMode: builder
              expr: label_replace(vector(1), "time_period", "$time_window", "", "")
              hide: false
              instant: false
              interval: ""
              legendFormat: __auto
              range: true
              refId: time_window
          title: Time Window
          transformations:
            - id: labelsToFields
              options:
                mode: rows
            - id: organize
              options:
                excludeByName:
                    label: true
                indexByName: {}
                renameByName:
                    label: time_period
                    value: Time Window
          type: stat
        - datasource:
            type: prometheus
            uid: duplo-metrics
          description: The SLO's Objective value. Always between 0 and 100%
          fieldConfig:
            defaults:
                color:
                    mode: thresholds
                decimals: 1
                mappings: []
                max: 1
                min: 0
                thresholds:
                    mode: absolute
                    steps:
                        - color: super-light-blue
                          value: null
                unit: percentunit
            overrides: []
          gridPos:
            h: 4
            w: 5
            x: 14
            "y": 0
          id: 3
          options:
            colorMode: value
            graphMode: none
            justifyMode: auto
            orientation: auto
            percentChangeColorMode: standard
            reduceOptions:
                calcs:
                    - lastNotNull
                fields: ""
                values: false
            showPercentChange: false
            textMode: value
            wideLayout: true
          targets:
            - datasource:
                type: prometheus
                uid: duplo-metrics
              editorMode: builder
              expr: vector($objective)
              hide: false
              instant: false
              interval: ""
              legendFormat: __auto
              range: true
              refId: A
          title: SLO
          type: stat
        - datasource:
            type: datasource
            uid: grafana
          gridPos:
            h: 4
            w: 3
            x: 19
            "y": 0
          id: 14
          options:
            code:
                language: plaintext
                showLineNumbers: false
                showMiniMap: false
            content: "<div style=\"display: flex; align-items: center; justify-content: center; height: 80px; font-family: Arial, sans-serif;\">\n    <a href=\"/d/manage-slo/manage-slo?var-duplo_uuid=$duplo_uuid\" \n       style=\"display: inline-block; padding: 15px 30px; background-color: #28a745; color: white; text-decoration: none; border-radius: 5px; font-size: 20px;\">\n        Edit SLO\n    </a>\n</div>"
            mode: html
          targets:
            - datasource:
                type: datasource
                uid: grafana
              refId: A
          title: Edit SLO
          type: text
        - datasource:
            name: -- Grafana --
            type: datasource
            uid: grafana
          description: ""
          gridPos:
            h: 4
            w: 2
            x: 22
            "y": 0
          id: 15
          options:
            buttonGroup:
                orientation: center
                size: lg
            confirmModal:
                body: Are you sure, you want to delete SLO ?
                cancel: Cancel
                columns:
                    include: []
                    name: Name
                    newValue: New Value
                    oldValue: name
                confirm: Confirm
                elementDisplayMode: all
                title: Delete SLO
            elementValueChanged: ""
            elements:
                - allowCustomValue: false
                  fieldName: name
                  id: name
                  labelWidth: 20
                  options: []
                  optionsSource: Custom
                  section: ""
                  title: Name
                  tooltip: ""
                  type: disabled
                  uid: d000d53c-f511-4fb0-94cc-1cf4840f7101
                  unit: ""
                  value: ""
                - allowCustomValue: false
                  fieldName: uuid
                  id: uuid
                  labelWidth: 20
                  options: []
                  optionsSource: Custom
                  section: ""
                  title: UUID
                  tooltip: ""
                  type: disabled
                  uid: 491efdf3-95a4-46fd-8b85-7eaa40d3f1e9
                  unit: ""
                  value: ""
                - allowCustomValue: false
                  fieldName: description
                  id: description
                  labelWidth: 20
                  options: []
                  optionsSource: Custom
                  section: ""
                  title: Description
                  tooltip: ""
                  type: disabled
                  uid: e6287c42-1a07-40c0-9781-50dee700c75f
                  unit: ""
                  value: ""
                - allowCustomValue: false
                  fieldName: objective
                  id: objective
                  labelWidth: 20
                  options: []
                  optionsSource: Custom
                  section: ""
                  title: Objective
                  tooltip: ""
                  type: disabled
                  uid: d93232d1-902d-41a2-917f-537310c9da3f
                  unit: ""
                  value: 0
                - allowCustomValue: false
                  fieldName: time_window
                  id: time_window
                  labelWidth: 20
                  options: []
                  optionsSource: Custom
                  section: ""
                  title: Time Window
                  tooltip: ""
                  type: disabled
                  uid: new-uid-1
                  unit: ""
                  value: 0
                - allowCustomValue: false
                  fieldName: type
                  id: type
                  labelWidth: 20
                  options: []
                  optionsSource: Custom
                  section: ""
                  title: Type
                  tooltip: ""
                  type: disabled
                  uid: new-uid-2
                  unit: ""
                  value: ratio
                - allowCustomValue: false
                  fieldName: success_metric
                  id: success_metric
                  labelWidth: 20
                  options: []
                  optionsSource: Custom
                  section: ""
                  title: Success Metric
                  tooltip: ""
                  type: disabled
                  uid: new-uid-3
                  unit: ""
                  value: ""
                - allowCustomValue: false
                  fieldName: total_metric
                  id: total_metric
                  labelWidth: 20
                  options: []
                  optionsSource: Custom
                  section: ""
                  title: Total Metric
                  tooltip: ""
                  type: disabled
                  uid: new-uid-4
                  unit: ""
                  value: ""
            initial:
                code: |-
                    if (context.panel.response?.error) {
                      context.grafana.notifyError(['An error occurred. Please check the form details.']);
                    } else {
                      context.grafana.notifySuccess(['Update', 'Values fetched successfully.']);
                      context.panel.enableSubmit();
                    }
                contentType: application/json
                datasource: duplo-automation
                getPayload: ""
                highlight: false
                highlightColor: green
                method: datasource
                payload:
                    columns: []
                    computed_columns: []
                    filters: []
                    format: as-is
                    global_query_id: ""
                    parser: backend
                    refId: ""
                    root_selector: ""
                    source: url
                    type: json
                    uql: parse-json
                    url: /integrations/slo?uuid=$duplo_uuid
                    url_options:
                        body_content_type: text/plain
                        body_type: raw
                        data: ""
                        method: GET
            layout:
                orientation: horizontal
                padding: 20
                sectionVariant: default
                variant: none
            reset:
                backgroundColor: purple
                foregroundColor: yellow
                icon: process
                text: Delete SLO
                variant: hidden
            resetAction:
                code: ""
                confirm: false
                datasource: duplo-automation
                getPayload: ""
                mode: initial
                payload:
                    columns: []
                    filters: []
                    format: table
                    global_query_id: ""
                    parser: backend
                    refId: ""
                    root_selector: ""
                    source: url
                    type: json
                    url: ""
                    url_options:
                        body_content_type: text/plain
                        body_type: none
                        data: ""
                        method: POST
            saveDefault:
                icon: save
                text: Save Default
                variant: hidden
            submit:
                backgroundColor: purple
                foregroundColor: yellow
                icon: process
                text: Delete SLO
                variant: destructive
            sync: false
            update:
                code: "console.log(context.panel.response)\r\nif (context.panel.response?.error) {\r\n  context.grafana.notifyError(['Update', 'An error occurred in deleting SLO.']);\r\n  context.grafana.refresh();\r\n} else {\r\n  context.grafana.notifySuccess(['Update', 'Slo deleted successfully.']);\r\n}"
                confirm: true
                contentType: application/json
                datasource: duplo-automation
                getPayload: ""
                header: []
                method: datasource
                payload:
                    columns: []
                    filters: []
                    format: as-is
                    global_query_id: ""
                    parser: backend
                    refId: ""
                    root_selector: ""
                    source: url
                    type: json
                    url: /integrations/slo/delete?uuid=$duplo_uuid
                    url_options:
                        body_content_type: application/json
                        body_form: []
                        body_type: none
                        data: "{\r\n    \"name\": \"${payload.name}\",\r\n    \"uuid\": \"${payload.uuid}\",\r\n    \"description\": \"${payload.description}\",\r\n    \"objective\": \"${payload.objective}\",\r\n    \"time_window\": \"${payload.time_window}\",\r\n    \"type\": \"${payload.type}\",\r\n    \"success_metric\": \"${payload.success_metric}\",\r\n    \"total_metric\": \"${payload.total_metric}\"\r\n}"
                        method: POST
                        params: []
                payloadMode: custom
            updateEnabled: manual
          targets:
            - datasource:
                type: datasource
                uid: grafana
              queryType: randomWalk
              refId: A
          title: Delete SLO
          type: volkovlabs-form-panel
        - datasource:
            type: prometheus
            uid: duplo-metrics
          description: ""
          fieldConfig:
            defaults:
                color:
                    mode: thresholds
                mappings:
                    - options:
                        from: 1e-10
                        result:
                            text: FIRING
                        to: 1
                      type: range
                    - options:
                        from: -1
                        result:
                            text: OK
                        to: 0
                      type: range
                thresholds:
                    mode: absolute
                    steps:
                        - color: green
                          value: null
                        - color: orange
                          value: 1
                unit: short
            overrides: []
          gridPos:
            h: 2
            w: 6
            x: 0
            "y": 4
          id: 4
          links:
            - asDropdown: false
              icon: ""
              includeVars: false
              keepTime: false
              targetBlank: true
              title: View alert rule
              tooltip: ""
              type: link
              url: /alerting/list?queryString=duplo_slo_severity%3Dcritical%2Cduplo_slo_uuid%3D$duplo_uuid
          options:
            colorMode: background
            graphMode: none
            justifyMode: auto
            orientation: vertical
            percentChangeColorMode: standard
            reduceOptions:
                calcs:
                    - lastNotNull
                fields: ""
                values: false
            showPercentChange: false
            textMode: value_and_name
            wideLayout: true
          targets:
            - datasource:
                type: prometheus
                uid: duplo-metrics
              editorMode: builder
              expr: max(ALERTS{duplo_slo_uuid="$duplo_uuid", duplo_slo_severity="critical"}) OR on() vector(0)
              hide: false
              instant: true
              interval: ""
              legendFormat: Critical alert
              range: false
              refId: A
          type: stat
        - datasource:
            type: prometheus
            uid: duplo-metrics
          description: Service level indicator
          fieldConfig:
            defaults:
                color:
                    mode: thresholds
                custom:
                    axisBorderShow: false
                    axisCenteredZero: false
                    axisColorMode: text
                    axisLabel: ""
                    axisPlacement: auto
                    axisSoftMax: 0.05
                    barAlignment: 0
                    barWidthFactor: 0.6
                    drawStyle: line
                    fillOpacity: 0
                    gradientMode: scheme
                    hideFrom:
                        legend: false
                        tooltip: false
                        viz: false
                    insertNulls: false
                    lineInterpolation: linear
                    lineWidth: 2
                    pointSize: 5
                    scaleDistribution:
                        type: linear
                    showPoints: auto
                    spanNulls: false
                    stacking:
                        group: A
                        mode: none
                    thresholdsStyle:
                        mode: "off"
                mappings: []
                thresholds:
                    mode: absolute
                    steps:
                        - color: red
                          value: null
                        - color: green
                          value: $objective
                unit: percentunit
            overrides: []
          gridPos:
            h: 7
            w: 13
            x: 6
            "y": 4
          id: 5
          links:
            - asDropdown: false
              icon: ""
              includeVars: true
              keepTime: true
              targetBlank: true
              title: Explore Raw SLI Query
              tooltip: Opens the raw SLI query in explore
              type: link
              url: /explore?schemaVersion=1&panes={"SLO":{"datasource":"duplo-metrics","queries":[{"refId":"SLI Query","expr":"(sum(rate($success_metric[$__rate_interval] offset 2m)) or 0 * sum(rate($total_metric[$__rate_interval] offset 2m))) / sum(rate($total_metric[$__rate_interval] offset 2m))","queryType":"range","datasource":{"type":"","uid":"duplo-metrics"},"editorMode":"true"}],"range":{"from":"${__from}","to":"${__to}"}}}&orgId=1
          options:
            legend:
                calcs: []
                displayMode: list
                placement: bottom
                showLegend: false
            tooltip:
                mode: single
                sort: none
          targets:
            - datasource:
                type: prometheus
                uid: duplo-metrics
              editorMode: builder
              expr: avg_over_time(duplo_slo_sli_5m{duplo_slo_uuid="$duplo_uuid"}[$__interval:])
              hide: false
              instant: false
              interval: 1m
              legendFormat: __auto
              queryType: linear
              range: true
              refId: recorded_data
            - datasource:
                type: prometheus
                uid: duplo-metrics
              editorMode: code
              expr: ((sum(rate($success_metric[$__rate_interval] offset 2m)) or 0 * sum(rate($total_metric[$__rate_interval] offset 2m))) / sum(rate($total_metric[$__rate_interval] offset 2m))) AND timestamp(sum(rate($total_metric[$__rate_interval] offset 2m))) < $curr_ts
              hide: false
              instant: false
              interval: 1m
              legendFormat: __auto
              queryType: linear
              range: true
              refId: computed_before_creation_time
          title: SLI
          type: timeseries
        - datasource:
            type: prometheus
            uid: duplo-metrics
          description: Service level indicator's value over the last $time_window
          fieldConfig:
            defaults:
                color:
                    mode: thresholds
                decimals: 2
                mappings: []
                max: 1
                min: 0
                thresholds:
                    mode: absolute
                    steps:
                        - color: red
                          value: null
                        - color: green
                          value: $objective
                unit: percentunit
            overrides: []
          gridPos:
            h: 7
            w: 5
            x: 19
            "y": 4
          id: 6
          options:
            colorMode: value
            graphMode: area
            justifyMode: auto
            orientation: auto
            percentChangeColorMode: standard
            reduceOptions:
                calcs:
                    - lastNotNull
                fields: ""
                values: false
            showPercentChange: false
            textMode: auto
            wideLayout: true
          targets:
            - datasource:
                type: prometheus
                uid: duplo-metrics
              editorMode: builder
              expr: |-
                # omit NaN by comparing to Infinity
                sum(sum_over_time((duplo_slo_success_rate_5m{duplo_slo_uuid="$duplo_uuid"} < 1e308)[$time_window:5m]))
                / sum(sum_over_time((duplo_slo_total_rate_5m{duplo_slo_uuid="$duplo_uuid"} < 1e308)[$time_window:5m]))
              hide: false
              instant: false
              interval: ""
              legendFormat: __auto
              range: true
              refId: recorded_data
          title: SLI (last $time_window)
          type: stat
        - datasource:
            type: prometheus
            uid: duplo-metrics
          description: ""
          fieldConfig:
            defaults:
                color:
                    mode: thresholds
                mappings:
                    - options:
                        from: 1e-10
                        result:
                            text: FIRING
                        to: 1
                      type: range
                    - options:
                        from: -1
                        result:
                            text: OK
                        to: 0
                      type: range
                thresholds:
                    mode: absolute
                    steps:
                        - color: green
                          value: null
                        - color: orange
                          value: 1
                unit: short
            overrides: []
          gridPos:
            h: 2
            w: 6
            x: 0
            "y": 6
          id: 7
          links:
            - asDropdown: false
              icon: ""
              includeVars: false
              keepTime: false
              targetBlank: true
              title: View alert rule
              tooltip: ""
              type: link
              url: /alerting/list?queryString=duplo_slo_severity%3Dwarning%2Cduplo_slo_uuid%3D$duplo_uuid
          options:
            colorMode: background
            graphMode: none
            justifyMode: auto
            orientation: vertical
            percentChangeColorMode: standard
            reduceOptions:
                calcs:
                    - lastNotNull
                fields: ""
                values: false
            showPercentChange: false
            textMode: value_and_name
            wideLayout: true
          targets:
            - datasource:
                type: prometheus
                uid: duplo-metrics
              editorMode: builder
              expr: max(ALERTS{duplo_slo_uuid="$duplo_uuid", duplo_slo_severity="warning"}) OR on() vector(0)
              hide: false
              instant: true
              interval: ""
              legendFormat: Warning alert
              range: false
              refId: A
          type: stat
        - datasource:
            type: datasource
            uid: grafana
          description: All active alerts for this SLO
          gridPos:
            h: 17
            w: 6
            x: 0
            "y": 8
          id: 8
          options:
            alertInstanceLabelFilter: '{duplo_slo_uuid="$duplo_uuid"}'
            alertName: ""
            dashboardAlerts: false
            folder: ""
            groupBy:
                - duplo_slo_severity
            groupMode: custom
            maxItems: 20
            sortOrder: 1
            stateFilter:
                error: true
                firing: true
                noData: true
                normal: true
                pending: true
            viewMode: list
          targets:
            - datasource:
                type: datasource
                uid: grafana
              refId: A
          title: Burn Rate Alerts
          type: alertlist
        - datasource:
            type: prometheus
            uid: duplo-metrics
          description: |-
            If error budget is decreasing over time, it means that your service is spending its error budget faster than it's earning it back.

            If error budget is increasing over time, you're not spending too much of your error budget.
          fieldConfig:
            defaults:
                color:
                    mode: thresholds
                custom:
                    axisBorderShow: false
                    axisCenteredZero: false
                    axisColorMode: text
                    axisLabel: ""
                    axisPlacement: auto
                    axisSoftMax: 1
                    axisSoftMin: 0
                    barAlignment: 0
                    barWidthFactor: 0.6
                    drawStyle: line
                    fillOpacity: 0
                    gradientMode: scheme
                    hideFrom:
                        legend: false
                        tooltip: false
                        viz: false
                    insertNulls: false
                    lineInterpolation: linear
                    lineWidth: 1
                    pointSize: 5
                    scaleDistribution:
                        type: linear
                    showPoints: auto
                    spanNulls: false
                    stacking:
                        group: A
                        mode: none
                    thresholdsStyle:
                        mode: "off"
                mappings: []
                thresholds:
                    mode: absolute
                    steps:
                        - color: red
                          value: null
                        - color: yellow
                          value: 0
                        - color: green
                          value: 0.2
                unit: percentunit
            overrides: []
          gridPos:
            h: 7
            w: 13
            x: 6
            "y": 11
          id: 9
          options:
            legend:
                calcs: []
                displayMode: list
                placement: bottom
                showLegend: false
            tooltip:
                mode: single
                sort: none
          targets:
            - datasource:
                type: prometheus
                uid: duplo-metrics
              editorMode: builder
              expr: |-
                (
                		# omit NaN by comparing to Infinity
                		sum(sum_over_time((duplo_slo_success_rate_5m{duplo_slo_uuid="$duplo_uuid"} < 1e308)[$time_window:5m]))
                		/ sum(sum_over_time((duplo_slo_total_rate_5m{duplo_slo_uuid="$duplo_uuid"} < 1e308)[$time_window:5m]))
                		- on() duplo_slo_objective{duplo_slo_uuid="$duplo_uuid"}
                	)
                	/ on () (1 - duplo_slo_objective{duplo_slo_uuid="$duplo_uuid"})
              hide: false
              instant: false
              interval: 1m
              legendFormat: __auto
              range: true
              refId: error_budget_trend
          title: Error Budget Trend
          type: timeseries
        - datasource:
            type: prometheus
            uid: duplo-metrics
          description: The unspent error budget over the last {$objective $time_window} Window
          fieldConfig:
            defaults:
                color:
                    mode: thresholds
                mappings: []
                max: 1
                min: 0
                thresholds:
                    mode: absolute
                    steps:
                        - color: red
                          value: null
                        - color: yellow
                          value: 0
                        - color: green
                          value: 0.2
                unit: percentunit
            overrides: []
          gridPos:
            h: 7
            w: 5
            x: 19
            "y": 11
          id: 10
          options:
            colorMode: value
            graphMode: area
            justifyMode: auto
            orientation: horizontal
            percentChangeColorMode: standard
            reduceOptions:
                calcs:
                    - lastNotNull
                fields: ""
                values: false
            showPercentChange: false
            textMode: auto
            wideLayout: true
          targets:
            - datasource:
                type: prometheus
                uid: duplo-metrics
              editorMode: builder
              exemplar: false
              expr: |-
                (
                		# omit NaN by comparing to Infinity
                		sum(sum_over_time((duplo_slo_success_rate_5m{duplo_slo_uuid="$duplo_uuid"} < 1e308)[$time_window:5m]))
                		/ sum(sum_over_time((duplo_slo_total_rate_5m{duplo_slo_uuid="$duplo_uuid"} < 1e308)[$time_window:5m]))
                		- on() duplo_slo_objective{duplo_slo_uuid="$duplo_uuid"}
                	)
                	/ on () (1 - duplo_slo_objective{duplo_slo_uuid="$duplo_uuid"})
              hide: false
              instant: true
              interval: ""
              legendFormat: __auto
              range: false
              refId: A
          title: Remaining Error Budget
          type: stat
        - datasource:
            type: prometheus
            uid: duplo-metrics
          description: The burn rate is the rate that this SLO is spending its error budget over last 5 min [0, 1.0]. A 1x burn rate will consume the entire error budget allotted for that period.
          fieldConfig:
            defaults:
                color:
                    mode: thresholds
                custom:
                    axisBorderShow: false
                    axisCenteredZero: false
                    axisColorMode: text
                    axisLabel: ""
                    axisPlacement: auto
                    axisSoftMin: 0
                    barAlignment: 0
                    barWidthFactor: 0.6
                    drawStyle: line
                    fillOpacity: 0
                    gradientMode: scheme
                    hideFrom:
                        legend: false
                        tooltip: false
                        viz: false
                    insertNulls: false
                    lineInterpolation: smooth
                    lineWidth: 2
                    pointSize: 5
                    scaleDistribution:
                        type: linear
                    showPoints: never
                    spanNulls: false
                    stacking:
                        group: A
                        mode: none
                    thresholdsStyle:
                        mode: "off"
                mappings: []
                thresholds:
                    mode: absolute
                    steps:
                        - color: green
                          value: null
                        - color: yellow
                          value: 1
                        - color: dark-red
                          value: 3
                unit: none
            overrides: []
          gridPos:
            h: 7
            w: 13
            x: 6
            "y": 18
          id: 11
          options:
            legend:
                calcs: []
                displayMode: list
                placement: bottom
                showLegend: false
            tooltip:
                mode: single
                sort: none
          targets:
            - datasource:
                type: prometheus
                uid: duplo-metrics
              editorMode: builder
              expr: |-
                avg without(duplo_slo_version) (1 - avg_over_time((duplo_slo_sli_5m{duplo_slo_uuid="$duplo_uuid"} < 1e308)[$__interval:]))
                / on(duplo_slo_uuid) group_left() avg without(duplo_slo_version) (1 - avg_over_time((duplo_slo_objective{duplo_slo_uuid="$duplo_uuid"} < 1e308)[$__interval:]))
              hide: false
              instant: false
              interval: 1m
              legendFormat: __auto
              range: true
              refId: recorded_data
            - datasource:
                type: prometheus
                uid: duplo-metrics
              editorMode: code
              expr: ((1 - ((sum(rate($success_metric[$__rate_interval] offset 2m)) or 0 * sum(rate($total_metric[$__rate_interval] offset 2m))) / sum(rate($total_metric[$__rate_interval] offset 2m)))) / (1 - $objective)) AND timestamp(sum(rate($total_metric[$__rate_interval] offset 2m))) < $curr_ts
              hide: false
              instant: false
              interval: 1m
              legendFormat: __auto
              range: true
              refId: computed_before_creation_time
          title: Error Budget Burn Rate
          type: timeseries
        - datasource:
            type: datasource
            uid: duplo-metrics
          description: The burn rate is the rate that this SLO is spending its error budget over last 5 min [0, 1.0]. A 1x burn rate will consume the entire error budget allotted for that period.
          fieldConfig:
            defaults:
                color:
                    mode: thresholds
                decimals: 2
                mappings: []
                thresholds:
                    mode: absolute
                    steps:
                        - color: green
                          value: null
                        - color: '#EAB839'
                          value: 1
                        - color: dark-red
                          value: 3
                unit: none
            overrides: []
          gridPos:
            h: 7
            w: 5
            x: 19
            "y": 18
          id: 12
          options:
            colorMode: value
            graphMode: none
            justifyMode: auto
            orientation: auto
            percentChangeColorMode: standard
            reduceOptions:
                calcs:
                    - lastNotNull
                fields: ""
                values: false
            showPercentChange: false
            textMode: auto
            wideLayout: true
          targets:
            - datasource:
                type: prometheus
                uid: duplo-metrics
              editorMode: builder
              exemplar: false
              expr: |-
                avg without(duplo_slo_version) (1 - avg_over_time((duplo_slo_sli_5m{duplo_slo_uuid="$duplo_uuid"} < 1e308)[$__interval:]))
                / on(duplo_slo_uuid) group_left() avg without(duplo_slo_version) (1 - avg_over_time((duplo_slo_objective{duplo_slo_uuid="$duplo_uuid"} < 1e308)[$__interval:]))
              hide: false
              instant: false
              interval: ""
              legendFormat: __auto
              range: true
              refId: A
          title: Current Burn Rate
          type: stat
        - datasource:
            type: prometheus
            uid: duplo-metrics
          description: Total Rate (for SLIs that compare rate of successful events to rate of total events, this is the latter)
          fieldConfig:
            defaults:
                color:
                    mode: palette-classic
                custom:
                    axisBorderShow: false
                    axisCenteredZero: false
                    axisColorMode: text
                    axisLabel: ""
                    axisPlacement: auto
                    axisSoftMax: 0.05
                    barAlignment: 0
                    barWidthFactor: 0.6
                    drawStyle: line
                    fillOpacity: 0
                    gradientMode: none
                    hideFrom:
                        legend: false
                        tooltip: false
                        viz: false
                    insertNulls: false
                    lineInterpolation: linear
                    lineWidth: 2
                    pointSize: 5
                    scaleDistribution:
                        type: linear
                    showPoints: auto
                    spanNulls: false
                    stacking:
                        group: A
                        mode: none
                    thresholdsStyle:
                        mode: "off"
                mappings: []
                thresholds:
                    mode: absolute
                    steps:
                        - color: green
                          value: null
                        - color: red
                          value: 80
                unit: reqps
            overrides: []
          gridPos:
            h: 7
            w: 24
            x: 0
            "y": 25
          id: 13
          options:
            legend:
                calcs: []
                displayMode: list
                placement: bottom
                showLegend: true
            tooltip:
                mode: single
                sort: none
          targets:
            - datasource:
                type: prometheus
                uid: duplo-metrics
              editorMode: builder
              expr: sum by (duplo_slo_uuid) (duplo_slo_total_rate_5m{duplo_slo_uuid="$duplo_uuid"})
              hide: false
              instant: false
              interval: ""
              legendFormat: ""
              queryType: linear
              range: true
              refId: recorded_data
            - datasource:
                type: prometheus
                uid: duplo-metrics
              editorMode: code
              expr: (sum(rate($total_metric[$__rate_interval] offset 2m))) AND timestamp(sum(rate($total_metric[$__rate_interval] offset 2m))) < $curr_ts
              hide: false
              instant: false
              interval: ""
              legendFormat: ""
              queryType: linear
              range: true
              refId: computed_before_creation_time
          title: Event Rate
          type: timeseries
    refresh: ""
    revision: 1
    schemaVersion: 39
    tags:
        - slo
    templating:
        list: []
    time:
        from: now-3h
        to: now
    timepicker: {}
    timezone: browser
    title: $name-$duplo_uuid
    uid: $duplo_uuid
    weekStart: ""